# Kryptonight 1

* **Category**: Crypto
* **Description**: _I took a walk around the world to ease my troubled mind._

This challenge was quite straightforward. We are given something like this when we first connect to the server:

```
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000 -> b5a7f63abb94d07d1a6445c36c07c7e8327fe61b1647e391b4c7edae5de57a3d
86dcc8db477b74b38bf7b0dad4e058c334a8450dab10c860f2ec19b650b061e14ebed698b5aae010c75dbf0538ce5fd1a8b1ad18f550f9b6bc4b0f17c8af30374740c75d6a4ce6c5079982c75b89e672ae777d624ae9855c9f2cb89bc9612c7fd191ea312d776b3d8757480297a70c9b2f74a9d9964cc6691b8e3db43fcc5e31fa916842402b09
........
```

We can see that there are three things here:

* 86 characters of zeroes
* 64 character hash
* 4000 characters of hex

Running it a few times we see that the first line remains unchanged throughout. Let's try to google for `b5a7f63abb94d07d1a6445c36c07c7e8327fe61b1647e391b4c7edae5de57a3d`, to try and reverse the hash.

## Good ol' Google

We see that it's a [test case](https://github.com/monero-project/monero/blob/master/tests/hash/tests-slow-1.txt) in a Monero hash algorithm. Looking at the source code for the test, it's calling a function called `cn_slow_hash_1`.

Rather than try to recompile the C++ and die while resolving all the libraries and dependencies, let's see if there are Python (or other language) bindings for this particular hash algorithm.

## Python bindings

We found one Python library: [pycryptonight](https://github.com/ph4r05/py-cryptonight), which seems to support both the fast and slow hash algorithms, as well as both variants of the slow hash algorithm.

We can confirm that the library returns the exact same hash when putting in `00000000000000000000000000000000000000000000000000000000000000000000000000000000000000` as bytes, and inferring that the last chunk of text is our input to be hashed, the rest of the script is easy enough to write, which can be found [here](https://github.com/irvinlim/crossctf-2018-quals/blob/master/crypto/kryptonight-1/exploit.py).

## Flag

```sh
$ nc ctf.pwn.sg 1502
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000 -> b5a7f63abb94d07d1a6445c36c07c7e8327fe61b1647e391b4c7edae5de57a3d
d8361f2ce52f7e754caf383b75fcad68b0894b1300438d7322278662bed2fe2ab4cd08022eee14c117e9a8d2029cb7769f662b7bb89f76f217dd1c545ab1ffadf57c1780c6a51fbbe8f9a6c55e39aed83d7c69671a96f9f71252609766c3342e206bc287367938d6c96f7158569c9389bc25ed575ac9d999993aea0ab757bb5586d796f5e99b0474fbfc91161bcff587e13ae775251574d1f583ece3c9be616f544d2a7facc56605ddece64e3c6467f6e629ebecb433e5e86d3ef95dcc882ed1fec08b5fd8b666f8ac7e1624dd6e2ea8dcdb52b1e8b17b486f7e14b0d468240921b65bca011b385924f65d1337323c091abb525922d3675472e3879e1b0f01a624749ab6312a1be4d061b6cfc3ab8be2f09d90c4ac192c56ab0423b6ce22f3f54a3feed608e7dbe18d5988a6f58f9c7034a022f548fb9519ca47fe9131254edcd535d057a4670bf8a29b158cb0326d206e2520dc761caff1400570f331a3a2d0bc2a2c10bdb7646bf8b010fc34d11f5a37936712e4b225b9e89dad6da74d5517bf18409c3a2770cdfb5cbb31828076e4b047c546e32bac6c70d64bf30c6e0d86561cb50cc85b995dac187e0d3e0628debc09fbb1e78d48a51a595a910da146e17de42c80f6dce58eabff5a6a756efa51e23471faebbca0db859ce19a2dff609e3c1db877655a50123fcb4de4f9aad1aa3b558a25329c9036dff0aada823bda088232de7e7c72eba6494810e532ed3e1581b009eb46333b4bda3e8e25ca52690919b678ff3fc6d261b5588ff2cd1ab6e112188df34783e880b023afa9a2b90ed289b5ff28fca95ba05091e72d70aa1eb886cbb9fd849748c0c0a81255d3ed2dc6a5924da78ee3a0e26f3d95079aa9789bff2af569083b8e44ca933dde014fb518b73c08c7b6e1834dea876d213197f3d373b3aa2272319bfd894d696662a9f0864258e555744e87667178946bfc5aa4905d5d74ea44100bf5135a291c2239d80c335890cdc2d8d1ba13a351d5712a47790cbe3ae48ffacf97dde18681c94b118a704ad4c09c8b5d164ffbb8f6609317e36668b32885fb9ab6c5832b7e737c48a86f883bcdb3304a1c26513ac27e8cf081d8066b893495d635cb159efdeb1b9f1177e84a075c54942506b9d6e6028d7ec260acfa19d2478a75dc80ca8eb45efb5931dca838b434d5f830f847f992042b5ba8bdb02366760b80c3b759513190047679fcf06f5779fc128be4c6ccca248643322fa35696796e10f4391c012f810d27ba6fc3243009d8b0ee54c0463838f5917bb289689b232d5133c471903ac0973363e43e5e9ed744bb6489f6af3b9d35e4a73935d6cc25a907b4b723399602331d8796fc3b47acad55f4fc8fd986f857922cb498be104951fd70fa023bd66aed6f4761e453fc02e288efe2d300ae46c2c4aaffe614a4f160ee83a472aaa3676f9e64d3c8d19f19872c296a3c2284ea69b715daaeb4ecb9bfc740bffdfa7d73c7bdb9e34b3b2ce6e96ca62b7ae469d53bdaf9f772172ab58bb3eba88efabc5d342f77e1ce73d4e04b2adfa618549bf7717c667a53e2be4070edb6985cf9c16d70c4107aeaef8e3007ced5a47d22584803905407a7f3b9063446a5c086739495beab1abf6037e852bac07b7f5fde81887eca5654da74a254992e0cfc74e88921e92b81759ca7a58fb06200d48b87da4fc89670ad5c4ca788c7ef1eb4c07fc40220ba9bc546f67b0c65fb3c4996435c0419d186160077fb0daa8415911fb09d1b031402055cfcef4b383a4df82567a3033d758174e71ce9d02eb97687302b38618fd630d2d040972ae5d0099ad955de3a3f6b535467e0e2c82ee075ef21d9b8b01c4db1566d2b196732d8d6bb7bd2278c0bd50682561f94a53c5da208fc269de0b029fff96ab904e053506bdf0364c1a8d863c26f424a5c9b7483d7eae0a420d336d2468d3167e7b57e064c27f7dcea53444c27104ea43bc6b493b1f8c218f773d29fbefac55fdb438e90088a9c12101059b6f8748a3c647b5938a912bd6197033b3751d1893b07d82f6bcf03884bb924266cb66c0137bde9d8a2fb1d28e527cb4b09751157cb9b9fe9fb0db4bd40de6f0b5a42bbae7b32857707c9aace0511c2e85a4a46c9e5eb3ddc857a5de67bbddeda73ab71d826134c41c87a26d800bc051feba2d30764ac5a9ce38f1b9951e0620126d8fb38292bc56f8ec14546f94dc6a4922c57051f86e588efbd46be56f768019fa45deb2ef6612efaa86c2c0ebc1c39a175e7f02a896f41a33becc33ba9d776481b89067b49360700635d1409bfd94edf3718c2fec23bead03962e7bbe9de94a1c800fcba1767853ee66986b181c3e55dac19bca2ca9e7226c3834fc21a181db128605bc7c7f48b7ac40cfa071dd040c6d7f90af812665a7501456f48a98eb70417de51ced747b90372041b2b03b657490f1383aef8a5c570d1eb96848905cb4aaa4346445206c8024239b4b510f0f69d247bf9277fd2b666f16e4721fa7c325aae48e643f58f376b4156b3de8609b575a87f13c90019a58d3695ba50517f6114a374dd826712926857025737e36777ed58a4be8c0c8d40eb81f514988940465b5ab4e596e5d2150a9054721ed4cd734b29cd147c3cd7ec7b42419f6efa539cf71dccf290a87337cfe87698f13e34edd52b7f163d3204c581008f00d7bcf9edfd67b6704e3d6b7513c259695db8f5a8c7d695a86085c5a8b1430f7c08b195c43281c3206fa48ae49b0d9d2a103bddbac8c5544a0e3c2a020b6063e8ce2cb8de3e20ba079d1dba2fea26af57647c2f6b656d1ca0de38c81f776f62339ab1897226?
ea3076aff629dfa3edb9e9c4ee8f5c157c630927426d0eb0554ebfd761431cf9
Flag: CrossCTF{h0dl_t1l_u_d1e}
```
