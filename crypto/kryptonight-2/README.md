# Kryptonight 2

* **Category**: Crypto
* **Description**: _Have I got a little story for you What you thought was your daddy Was nothin' but a_

This was almost exactly identical to [Kryptonight 1](https://github.com/irvinlim/crossctf-2018-quals/blob/master/crypto/kryptonight-1), but using the Cryptolite slow hash algorithm, variant 1 instead.

Initially, we tried using the C++ library from the Turtlecoin repository at first so that we could use the `cn_lite_slow_hash_v1` function from there, but we faced various issues trying to link various libraries and dependencies together using CMake.

Instead, we used this Node.js library [cryptonight-hashing](https://github.com/MoneroOcean/node-cryptonight-hashing) instead, which happens to have what we need.

The script can be found [here](https://github.com/irvinlim/crossctf-2018-quals/blob/master/crypto/kryptonight-2/hash.js).

## Flag

```sh
$ nc ctf.pwn.sg 1503
0100fb8e8ac805899323371bb790db19218afd8db8e3755d8b90f39b3d5506a9abce4fa912244500000000ee8146d49fa93ee724deb57d12cbc6c6f3b924d946127c7a97418f9348828f0f02 -> 87c4e570653eb4c2b42b7a0d546559452dfab573b82ec52f152b7ff98e79446f
ff0e3c4011265ad1d8d1c0915d6447b1b1cac3109f54078ae6abdf528590070b665142d0902029bbe857e3183f81ffdde5ce55c817b6780875f16e60059b7a396938e58b21ff440a654f68d8d32425b9d29a0ac97826386b84e82255e73d7e858bb60ceac88e3c9d9269ce2ebedcf0ded451196b76f2c85eef95b17bdd4f2be8164fcd4fc34f146dc4a8f205f91d5139cfdaca04174cfc27861d57036df1e98f50bab192999d6787c888137707d5f093abbf8b7742f9c1e9856fe84334c79b37cb6fa73824109da1a3361f434aa0078ef620e3971d428c39cd9141def5f6d3978264cff1a722a731f7e9defd5cb4f1b44b2e78a5187a9dcf22debdc055f492fd956d36d274bfc037c8e2cb550d4bc851998eb651db8cd6b781b0442a895cd9eabdd65e1bca1afa41691a12299c0a9228422b02a844128d3a6e05d44ccbdc1f673725f3317a9c44cd7012103eb55494f48e8d88b6b206707f7535e47bffaa98852c1d932b29ac833757eb220c4075ef4d4c308f35164832aff7a32e6dd3797de3aacb314a02b116ff49660223e5e2b1f7194dc00ca66ac87de297629fdb7b75362518d20a96fcc0795120a201893f25a64972d0af079d5a02dcf514fe3d1126f867dd8fff6557b0e1efbf79f232a7b1c151c89bf6f6c987968e99ab4b27cd8beca0c845ea8be925f6d5fd79f77bf3ac2eadcbd91bef7e4f0269fef59b1f57789b02dce805fa3cf65ce8e0aa2135e8a6e1fd0a97555d0425f609bd5fd6b26efa7387107591695ceef1ba0e87061ebddb6caa4afbdb92976df408b86dd0add459d55335a79285191964a9683e023cc1d3a5352985eaca2f6bbb390a7c53b827f8844ac20b3db55c3e1b2f3feeacf2d3be205ad939e6d08209e8a91c3e0f184580b811b6b204e3044a707af63db40b167a3746c2bc2079b2df339f6f6625e096fce2156895d331405a2cde0dba79529ac4c79349206ab72797a90323141e1bd3a871fe41daaff27d31e2d887b1785ec139b78ae5c2c44b4bc7260e312dc54e18689b41a84bce9e055d5e0977c4e98d6dbec34496534fc601d690763f3d5eb7d6e712e07637c0b500b37a755f3e738eb0cae57a41c87dc38c974cbcbb53c4b08e6a5bf68e3759ca5412fe294ed3740e02b54b87acb794483f374e829aacae061f2f3927f64377bdb28bf6d716f0de2cb52b615ebaf81008a54d3d46960d932293e28cca87aced82ac95279db7df8d14d3d41d874b8784dd78a25399df2cc200f83cec454a54380914984e996f7038954cb36164d192962c85f10112e2178d2e90d7758a6b837431e6362a04703d21be5124b3d729b34b80f5a5704195913d6c64e2c9bef82ac32996f681c70a2e5f3ed0c6e7d546741992f3000f581af3ae0ddc28c40e9f985894c611b99a2fb555bb7608ec61d6e373acdcf4156eb496be4f5c7374988800bc9ddbfca61419cf7a108603b6bf2303bbeb7f2910497bf2ebb8eca35008af5cb5b1960018ccd389edff5b0b1474fdb98e75c62e46338c76fad54797a9a146ee2fbe7d0bc5b4eab5031b3b4e7d7759c0f61232c828f2796608bddd36e7f6ce450e33eb1f24998bf85115c2cea7395d69b1051b502fb48ddd47142d19e56c1a51a6a5cd72c791bf3cb48b1722eec74853735cd818f86dbb81609faf649289bf0d4f92da424e4df89c357e41984f3588a6244237250435109bf2462b27f779cec9d6c4cd5753703a07b69651220e149a0cc38382eb9f3c05e4c903081ef3e5b0da3cff93e5a4c6bf42f434fb013aa492481fca482010092139f3877ee1d5b4ce1d40e0585d59e76749063d8a8d1c73a0e55986c30a2cef0b12c309b114b50e8772d36d033b0142942b4461c071079dc4c4364cbd68b2a0942489797dab1a58efbd36cd2a1361b9ec103e1c340aa7385d2f7016fcbb8a51384cf10f1ef0313f2eede702fc28bc8ba7b5c3f4f12ffb1412c3e14ab814c07b986b0d274f75568b910fc77b81facb65def7d39de1feda4e60876a8dff37f65ae930898667cb9c350ca6bb966e7be52160a417feeb7b50b5b0914cfe693f8c075e444e9f03a7cfeba9e94e09ba9988535017cb6983b0a55cb485aa334b2cfce59e2019b2071448110d0fcefbcf93b06ea8581743a90cd4818accb6da7a1a2334cc7c690102364c1a3305fe295c0562d9c8edc632b2d27b40f209f0b8b50a5f1bb62b729a2aa9fc80e2c2dd7aa5ba135be0ab548a89837ad2023af26d860819ed9afc3cbfe57479f0644c1c4875d5120764be9585950b5ce3c16dc6fcd16dc1e7d542ffeff01e9c2bf8f5d3c353581fd69b6bc75aace126ca3c3788f301a5b99fc3802e092775e213af3584fd754c56358a6ed8168343454259314e502dded993f9a6211fe17c46cda7e0a7617405945ed1983d001694e7e2edcab98820e1f532e26c7d9f3377222badf9518219ea12487059467829053565b4ada0f1593bcfd46b5f34037d97f4c06c0a151bac5cdfa60156797db0650dfcb2280d4563ba4f4b59a71f2654f57e4a3f60138489a5a1ba6432e42e8aff32cd16be1bfa3b4df05e4afb1291b3e14445b5f5aea6398b68f500739f842cfcbf7ddb4b1e97bb6474f05d06354be2a93e36585af672875f37631f7e3042bffdf79eeb6fe28fa592b662981e43d13e5504f308f9bcd10a76ba863cd1d867f78e427ce8f7fc9efbc27e3a057899a2154b8061d2509217f4cf616f7b9faa79568c5526727429fd292580b3bfd2056f49d36495ccea5fa43db3e840a130cd6caae4783575492d6eff04f4b6018a3e74ef5683329ce6416b0249d1e904748291719a1d?
418f1f2d6209a85634b5bae868cd3525678ddf79ed029479f5736f0b4583a309
Flag: CrossCTF{d3ny_y0ur_m4ker_w3ll_b3_w4st1ng}
```
